<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASCII Video</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>
<body>
    <div id="asciiContainer"></div>

    <script>
        const density = "Ã‘@#W$9876543210?!abc;:+=-,._          ";
        let video;
        let asciiDiv;

        function setup() {
            noCanvas();
            asciiDiv = createDiv();
            
            // Load video from GitHub repository
            video = createVideo("https://github.com/19XX/asciivid_test1/blob/main/asclowres.mp4", videoLoaded);
            video.size(64, 48);
            video.hide(); // Hide actual video
        }

        function videoLoaded() {
            video.loop(); // Ensure video is playing in a loop
            video.volume(0); // Mute the video to prevent any sound
        }

        function draw() {
            if (video.loadedmetadata) {
                video.loadPixels();
                let asciiImage = "";

                for (let j = 0; j < video.height; j++) {
                    for (let i = 0; i < video.width; i++) {
                        const pixelIndex = (i + j * video.width) * 4;
                        const r = video.pixels[pixelIndex + 0];
                        const g = video.pixels[pixelIndex + 1];
                        const b = video.pixels[pixelIndex + 2];
                        const avg = (r + g + b) / 3;
                        const len = density.length;
                        const charIndex = Math.floor(map(avg, 0, 255, 0, len - 1));
                        const c = density.charAt(charIndex);
                        asciiImage += c === " " ? "&nbsp;" : c;
                    }
                    asciiImage += "<br/>";
                }
                
                asciiDiv.html(asciiImage);
            }
        }
    </script>
</body>
</html>
